# QA 테스트 데이터셋 v2 안내

> **작성일**: 2026-02-11
> **작성자**: Claude Code (AI)
> **대상 파일**: `qa_test/bizi_qa_dataset_v2.md`

---

## 1. 이게 뭔가요?

Bizi 챗봇의 **답변 품질을 자동으로 테스트**하기 위한 QA 데이터셋입니다.

- v1 (`bizi_qa_dataset_unified.md`): 78개 — 기존 3개 파일 통합
- **v2 (`bizi_qa_dataset_v2.md`): 75개 — 신규 생성 (이 파일)**

v1 테스트에서 **PASS율 96.2%, 평균 90.8점**을 달성했고, v2는 더 다양한 도메인 조합과 새로운 페르소나로 추가 검증하기 위해 만들었습니다.

---

## 2. 데이터셋 구성

### 총 75개 질문

| Part | 유형 | 도메인 조합 | 개수 |
|------|------|------------|------|
| Part 1 | 단일 도메인 | hr(5) + tax(5) + startup(5) + law(5) | **20개** |
| Part 2 | 2개 도메인 복합 | 6개 조합 x 5 | **30개** |
| Part 3 | 3개 도메인 복합 | 4개 조합 x 5 | **20개** |
| Part 4 | 4개 도메인 복합 | 전체 x 5 | **5개** |

### 2개 도메인 조합 (Part 2)

| # | 조합 | 예시 질문 주제 |
|---|------|--------------|
| 1 | 인사 + 세무 | 급여 원천징수, 퇴직소득세, 고용증대세액공제 |
| 2 | 인사 + 창업 | 첫 직원 채용, 고용지원사업, 두루누리 |
| 3 | 인사 + 법률 | 부당해고, 근로자성 판단, 산업재해 |
| 4 | 세무 + 창업 | 간이과세, 창업감면, 보조금 세무처리 |
| 5 | 세무 + 법률 | 조세특례제한법, 가산세, 세무조사 |
| 6 | 창업 + 법률 | 프랜차이즈 가맹사업법, 전자상거래법, 보조금법 |

### 3개 도메인 조합 (Part 3)

| # | 조합 | 예시 질문 주제 |
|---|------|--------------|
| 1 | 인사 + 세무 + 창업 | 고용지원금 + 원천징수 + 채용지원사업 |
| 2 | 인사 + 세무 + 법률 | 임금체불 형사처벌 + 가산금 + 세무처리 |
| 3 | 세무 + 법률 + 창업 | 법인설립 등기 + 세무신고 + 지원사업 |
| 4 | 법률 + 창업 + 인사 | 학원법 + 강사 근로자성 + 인허가 |

### 4개 도메인 (Part 4)

모든 도메인이 관련된 종합 질문 5개 (예: 음식점 A to Z, 스타트업 법인 전환, 제조업 구조조정 등)

---

## 3. 난이도 분포

| 난이도 | 개수 | 비율 | 설명 |
|--------|------|------|------|
| Easy | 14 | 18.7% | 단순 절차/정의 질문 |
| Medium | 34 | 45.3% | 구체적 조건/비교 질문 |
| Hard | 27 | 36.0% | 복합 상황/다중 조건 질문 |

- Part 1 (단일): Easy 8, Medium 8, Hard 4
- Part 2 (2도메인): Easy 6, Medium 18, Hard 6
- Part 3 (3도메인): Medium 8, Hard 12
- Part 4 (4도메인): Hard 5 (전부 Hard)

---

## 4. 페르소나 (8명)

v1과 겹치지 않는 새로운 페르소나를 사용합니다.

| ID | 이름 | 나이 | 유형 | 업종 |
|----|------|------|------|------|
| PV01 | 강지우 | 28세 | 예비창업자 | 베이커리카페 |
| PV02 | 신하준 | 33세 | 예비창업자 | 피트니스센터 |
| PV03 | 조은서 | 36세 | 스타트업 CEO | 에듀테크 |
| PV04 | 류태민 | 42세 | 스타트업 CEO | 물류 플랫폼 |
| PV05 | 임서윤 | 47세 | 중소기업 대표 | 식품 제조업 |
| PV06 | 배준영 | 55세 | 중소기업 대표 | 건설업 |
| PV07 | 한소율 | 31세 | 소상공인 | 네일샵 |
| PV08 | 오동현 | 39세 | 예비창업자 | 음식점(치킨) |

---

## 5. 각 질문의 구조

모든 질문은 아래 정보를 포함합니다:

```
V-001. [제목] [난이도]
├── 도메인: hr / tax / startup / law (단일 또는 복합)
├── 난이도: Easy / Medium / Hard
├── 페르소나: PV01~PV08 중 하나
├── 질문: 페르소나 상황을 반영한 자연스러운 질문
├── 기대 답변: 도메인별 관점 구분 + 종합 안내
├── 답변 근거: 참조한 데이터 출처 목록
└── Evidence: 전처리 JSONL에서 발췌한 원문 인용 + 데이터 ID
```

---

## 6. 평가 기준

### LLM 자동 평가 (100점 만점)

| 항목 | 배점 | 설명 |
|------|------|------|
| 검색 품질 | 20점 | 검색된 문서가 질문과 관련있는가 |
| 정확성 | 20점 | 답변 내용이 정확한가 |
| 완성도 | 20점 | 질문에 빠짐없이 답했는가 |
| 관련성 | 20점 | 질문과 답변이 관련있는가 |
| 출처 명시 | 20점 | 근거 문서를 인용했는가 |

- **PASS**: 70점 이상
- **FAIL**: 70점 미만
- **목표**: PASS율 90% 이상

### 검증 항목 3가지

1. **도메인 라우팅** — 기대 도메인 에이전트가 호출되었는지
2. **답변 구조** — 도메인별 관점 섹션 + 종합 안내 + 답변 근거 블록 존재
3. **LLM 점수** — 5항목 100점 만점 채점

---

## 7. 테스트 실행 방법

```bash
# rag 디렉토리에서 실행
cd rag

# 전체 75건 배치 테스트
py run_qa_batch.py

# 일부만 테스트 (예: V-001 ~ V-010)
py run_qa_batch.py --start 1 --end 10
```

### 필수 .env 설정

```env
DOMAIN_CLASSIFICATION_THRESHOLD=0.4
ENABLE_HYBRID_SEARCH=true
ENABLE_RERANKING=true
TOTAL_TIMEOUT=300
```

### 결과 파일

| 파일 | 위치 | 설명 |
|------|------|------|
| 원시 데이터 | `rag/logs/qa_batch_{timestamp}.jsonl` | 질문별 상세 결과 |
| 요약 테이블 | `rag/logs/qa_batch_{timestamp}_summary.md` | 전체/난이도별 통계 |
| 분석 보고서 | `rag/reports/{날짜}_qa_batch_analysis.md` | 문제점/개선방안 자동 분석 |

---

## 8. v1과 v2 비교

| 항목 | v1 | v2 |
|------|----|----|
| 파일명 | `bizi_qa_dataset_unified.md` | `bizi_qa_dataset_v2.md` |
| 질문 수 | 78개 | 75개 |
| 페르소나 | PA01~PA12, PB01~PB08, PC01~PC03 (23명) | PV01~PV08 (8명, 신규) |
| 단일 도메인 | 16개 (startup 12, tax 4) | 20개 (각 5개씩 균등) |
| 2개 도메인 | 51개 (불균등) | 30개 (6조합 x 5 균등) |
| 3개 도메인 | 8개 | 20개 (4조합 x 5 균등) |
| 4개 도메인 | 2개 | 5개 |
| 도메인 거부 | 1개 | 별도 테스트 |
| **핵심 차이** | startup, tax에 편중 | **4개 도메인 완전 균등 분포** |

### v2의 개선점

1. **균등 분포** — 모든 도메인이 동일한 비중으로 테스트됨
2. **복합 도메인 강화** — 3도메인 8개 → 20개, 4도메인 2개 → 5개
3. **새로운 페르소나** — v1과 겹치지 않는 8명으로 다양한 사용자 시나리오
4. **실제 데이터 기반** — 전처리 JSONL 파일의 실제 ID와 내용을 Evidence에 반영

---

## 9. 파일 목록

| 파일 | 설명 |
|------|------|
| `qa_test/bizi_qa_dataset_v2.md` | **통합 데이터셋 (이것만 사용)** |
| `qa_test/README_qa_dataset_v2.md` | 이 안내 문서 |
| `qa_test/bizi_qa_dataset_unified.md` | v1 데이터셋 (기존) |
| `qa_test/qa_v2_part1_single.md` | v2 파트1 원본 (참고용) |
| `qa_test/qa_v2_part2a_2domain.md` | v2 파트2a 원본 (참고용) |
| `qa_test/qa_v2_part2b_2domain.md` | v2 파트2b 원본 (참고용) |
| `qa_test/qa_v2_part3_4_complex.md` | v2 파트3+4 원본 (참고용) |
