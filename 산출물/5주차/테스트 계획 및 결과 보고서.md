  
**SK네트웍스 Family AI 과정 20기**  
**테스트 계획 및 결과 보고서**

| 산출물 단계 | 모델링 및 평가 |
| :---- | :---- |
| **평가 산출물** | 테스트 계획 및 결과 보고서 |
| **제출 일자** | 2026-02-12 |
| **깃허브 경로** | https://github.com/SKNETWORKS-FAMILY-AICAMP/SKN20-FINAL-6TEAM/tree/main |
| **작성 팀원** | 정소영 |

# **프로젝트 개요**

본 보고서는 CEO를 위한 비즈니스 AI 에이전트 플랫폼 BIZI의 품질을 검증하기 위해 수행한 테스트 계획과 결과를 정리한 문서입니다. 플랫폼은 사용자의 질문을 도메인별로 분류한 후, 하위 질문으로 분해하고 검색-생성 과정을 거쳐 응답을 제공하며, 응답의 품질까지 평가하는 RAG(Retrieval-Augmented Generation) 기반 시스템입니다. 테스트는 기능적 요구 사항과 비기능적 요구 사항 모두를 다루어 성능과 안정성, 그리고 모델링 평가 결과를 확인하는 것을 목표로 합니다.

# **1\. 테스트 목적**

본 테스트의 목적은 다음과 같습니다:

**1\) 질문 분해 로직의 정확성 검증**

단일·복합 도메인 질문을 올바르게 분해하고 대화 이력을 활용하는지 확인합니다. 테스트 코드는 질문 분해 로직과 캐싱, 대화 이력 활용, 폴백 처리까지 포괄적으로 검증하도록 설계되어 있습니다.

**2\) 도메인 라우터 동작 검증**

메인 라우터가 질의를 정확히 분류하고 각 도메인 에이전트로 라우팅하는지, low/high confidence 시나리오에서 올바르게 continue/reject 분기를 처리하는지를 확인합니다.

**3\) 응답 품질 평가 모듈 검증**

RAGAS 평가지표를 통해 응답의 신뢰도(faithfulness), 관련성(answer relevancy), 컨텍스트 정밀도(context precision) 등을 산출하고, 평가 모듈이 비활성화되거나 설치되지 않은 환경에서도 graceful fallback이 이루어지는지 확인합니다.

**4\) 비기능적 요구 사항 검증**

캐싱 시스템을 통한 성능 개선, 비동기 처리의 정상 동작, 폴백 로직의 안정성 등을 검증하여 전체 파이프라인의 회복력(resilience)을 확보합니다.

# **2\. 테스트 환경**

테스트는 다음 환경에서 실행되었습니다:

| 구분 | 환경 |
| :---- | :---- |
| 언어 | Python 3.10+ |
| 테스트 프레임워크 | pytest, pytest-asyncio |
| 목업 라이브러리 | unittest.mock (MagicMock, AsyncMock, patch) |
| LLM API | OpenAI GPT-4o-mini |
| Vector Store | ChromaDB |
| 평가 라이브러리 | RAGAS (선택적 활성화) |

 

모든 외부 API는 Mock/patch 기법으로 격리하여 단위 테스트 수준에서 각 컴포넌트를 독립적으로 검증하였습니다. 테스트는 GitHub Actions와 같은 CI 환경을 가정하여 자동화되도록 구성했습니다.

# **3\. 테스트 대상 모듈**

## **3.1 Question Decomposer (test\_question\_decomposer.py)**

**테스트 파일:** test\_question\_decomposer.py (406줄)

**총 테스트 클래스:** 8개

**총 테스트 함수:** 25개

QuestionDecomposer는 사용자의 복합 질문을 분해하여 도메인별 하위 질문을 생성하고 캐시를 이용해 중복 호출을 방지하는 역할을 합니다.

| 테스트 클래스 | 테스트 수 | 검증 내용 |
| ----- | :---: | ----- |
| TestSingleDomainSkip | 3개 | 단일 도메인 시 LLM 호출 없이 원본 반환 |
| TestMultiDomainDecompose | 2개 | 2개/3개 도메인 복합 질문 분해 |
| TestFallback | 3개 | JSON 파싱 실패, 빈 결과, 잘못된 도메인 필터링 |
| TestHistory | 3개 | 대화 이력 포함 여부, 최대 3턴 제한 |
| TestCaching | 3개 | 캐시 히트/미스, 캐시 키 생성 로직 |
| TestAsync | 1개 | 비동기 분해 함수 (chain.ainvoke) |
| TestUtilityFunctions | 4개 | 헬퍼 함수 단위 테스트 |

 

**주요 검증 내용:**

• 단일 도메인 시 LLM 호출 없이 원본 반환. (출처: rag/tests/test\_question\_decomposer.py)

• 2\~3개 도메인 복합 질문을 도메인별 SubQuery로 정확히 분해

• JSON 파싱 실패 시 원본 질문을 각 도메인에 전달하여 Graceful Degradation 구현

• LRU 캐시(max\_size=200, ttl=3600초)를 통한 중복 호출 방지 및 응답 속도 개선

• 대화 이력 최근 3턴을 프롬프트에 포함하여 대명사 해소 ("그거" → 구체적 명사)

## **3.2 Main Router (test\_router.py)**

**테스트 파일:** test\_router.py (593줄)

**총 테스트 클래스:** 6개

**총 테스트 함수:** 22개

MainRouter는 질의를 도메인별로 분류한 후 적절한 에이전트로 라우팅하는 핵심 오케스트레이션 레이어입니다.

| 테스트 클래스 | 테스트 수 | 검증 내용 |
| ----- | :---: | ----- |
| TestRouterState | 1개 | RouterState 필수 필드 검증 |
| TestMainRouterInit | 5개 | 초기화, 의존성 주입, 에이전트 생성 |
| TestShouldContinueAfterClassify | 3개 | 분류 후 continue/reject 조건 분기 |
| TestClassifyNode | 3개 | 도메인 분류 노드 동작, 타이밍 메트릭 |
| TestLazyLoadingProperties | 4개 | 지연 로딩 프로퍼티 (classifier, decomposer, evaluator) |
| TestMainRouterEdgeCases | 3개 | 낮은/높은 신뢰도 엣지 케이스 |

 

**주요 검증 내용:**

• 4개 도메인 에이전트(startup\_funding, finance\_tax, hr\_labor, law\_common) 생성 확인

• 동기/비동기 그래프(graph, async\_graph) 모두 빌드 검증

• 분류 결과가 없으면 continue 반환. 관련 질문이면 continue 반환. 비관련 질문이면 reject 반환. (출처: rag/tests/test\_router.py)

• 낮은 신뢰도(0.55)여도 관련 질문이면 continue, 높은 신뢰도(0.99)로 비관련 판단 시 reject

• 도메인 분류기, 질문 분해기, RAGAS 평가기를 지연 로딩하여 초기화 시간 단축

## **3.3 RAGAS Evaluator (test\_ragas\_evaluator.py)**

**테스트 파일:** test\_ragas\_evaluator.py (143줄)

**총 테스트 클래스:** 2개

**총 테스트 함수:** 17개

RagasEvaluator는 응답의 품질을 정량적으로 평가하는 모듈로, faithfulness, answer relevancy, context precision, context recall 등의 지표를 제공합니다.

| 테스트 클래스 | 테스트 수 | 검증 내용 |
| ----- | :---: | ----- |
| TestRagasMetrics | 8개 | 메트릭 생성, available 플래그, to\_dict 반올림 |
| TestRagasEvaluator | 9개 | RAGAS 비활성화 처리, safe\_float 함수 |

 

**주요 검증 내용:**

• 유효한 메트릭이 있으면 available=True. 메트릭이 없으면 available=False. 에러만 있으면 available=False. (출처: rag/tests/test\_ragas\_evaluator.py)

• to\_dict()는 소수점 4자리로 반올림 (0.123456789 → 0.1235)

• RAGAS 미설치 시 is\_available=False, 에러 메시지 반환

• 설정에서 비활성화(enable\_ragas\_evaluation=False) 시 is\_available=False

• 단일/배치 평가 모두 비활성화 상태에서 에러 메트릭 반환

• \_safe\_float 함수가 None, NaN, invalid 값을 모두 None으로 변환하여 안정성 확보

# **4\. 테스트 케이스 통계 및 분류**

각 모듈별 테스트 함수 수를 집계하면 아래와 같습니다:

| 모듈 | 테스트 함수 수 | 파일 크기 |
| ----- | :---: | :---: |
| Question Decomposer | **25개** | 406줄 |
| Main Router | **22개** | 593줄 |
| RAGAS Evaluator | **17개** | 143줄 |
| **합계** | **64개** | **1,142줄** |

 

**테스트 케이스 분류:**

| 분류 | 내용 |
| :---: | ----- |
| **기능 테스트** | 단일·복합 도메인 분해, 도메인 분류 및 라우팅, 평가 지표 생성과 연동 |
| **안정성 테스트** | JSON 파싱 실패, 빈 결과, 관련 없는 질문, 평가 모듈 비활성화 등 예외 상황에서 시스템이 중단 없이 폴백하는지 확인 |
| **성능 테스트** | LRU 캐시 히트/미스, 도메인 순서에 관계없는 캐시 키 생성, 비동기 분해 함수, 타이밍 메트릭 기록 |
| **통합 테스트** | 도메인 분류 → 질문 분해 → 검색 및 응답 생성 → 평가까지 End-to-End 흐름 검증 |

 

# **5\. 테스트 실행 결과**

## **5.1 전체 테스트 통과율**

| 전체 테스트 | 통과 | 실패 |
| :---: | :---: | :---: |
| **75** | **69 (92.0%)** | **0 (0.0%)** |

**결과: ERROR 6 (출처: 2026-02-12\_qa\_batch\_analysis.md)**

## **5.2 성능 및 안정성 결과**

**1\) ERROR 6건 (출처: 2026-02-12\_qa\_batch\_analysis.md)**

• V-029 (hr \+ startup, Medium): 'MainRouter' object has no attribute 'rag\_chain'; V-038 (tax \+ startup, Medium): 'MainRouter' object has no attribute 'rag\_chain'; V-046 (startup \+ law, Medium): 'MainRouter' object has no attribute 'rag\_chain' (출처: 2026-02-12\_qa\_batch\_analysis.md)

• V-053 (hr \+ tax \+ startup, Hard): 'MainRouter' object has no attribute 'rag\_chain'; V-071 (hr \+ tax \+ startup \+ law, Hard): 'MainRouter' object has no attribute 'rag\_chain'; V-072 (hr \+ tax \+ startup \+ law, Hard): 'MainRouter' object has no attribute 'rag\_chain' (출처: 2026-02-12\_qa\_batch\_analysis.md)

**2\) 난이도별 통계 (출처: 2026-02-12\_qa\_batch\_analysis.md)**

| Difficulty | Value 1 | Value 2 | Value 3 | Value 4 | Value 5 | Score | Source |
| :---- | :---- | :---- | :---- | :---- | :---- | :---- | :---- |
| Easy | 14 | 14 | 0 | 0 | 0 | 90.6 | 2026-02-12\_qa\_batch\_analysis.md |
| Medium | 34 | 31 | 0 | 0 | 3 | 90.8 | 2026-02-12\_qa\_batch\_analysis.md |
| Hard | 27 | 24 | 0 | 0 | 3 | 91.8 | 2026-02-12\_qa\_batch\_analysis.md |

 

**3\) 처리시간 및 비용 (출처: 2026-02-12\_qa\_batch\_analysis.md)**

• PASS 평균 처리시간 51.8초, 전체 평균 처리시간 52.6초 (출처: 2026-02-12\_qa\_batch\_analysis.md)

• 총 토큰 685,684, 총 API 비용 $0.1498 (출처: 2026-02-12\_qa\_batch\_analysis.md)

**4\) 긍정적 발견 (출처: 2026-02-12\_qa\_batch\_analysis.md)**

| 항목 | 값 |
| :---- | :---- |
| FAIL | 0건 |
| 도메인 분류 통과 질문 PASS | 69/69 \= 100% |
| 평균 점수 | 91.1/100 |
| 만점 | 1건: V-020 |
| 복합 도메인(3+) 처리 성공 | 56건 |
| 비용 | 총 $0.1498 |
| 출처 | 2026-02-12\_qa\_batch\_analysis.md |

 

# **6\. 모델링 평가 결과 전반**

평가 항목별 평균 (출처: 2026-02-12\_qa\_batch\_analysis.md)

| 검증 항목 | 평균 | 최저 | 최고 | 검증 결과 |
| :---: | :---: | :---: | :---: | ----- |
| **검색 품질** | 17.8 | 15 | 20 | 검색 품질 평가에서는 평균 점수가 17.8점으로 나타났으며, 최저 점수는 15점, 최고 점수는 20점입니다. 이는 검색 기능이 전반적으로 양호한 성능을 보였음을 의미합니다. |
| **정확성** | 18.9 | 18 | 20 | 정확성 항목에서는 평균 점수가 18.9점으로 기록되었습니다. 최저 점수는 18점, 최고 점수는 20점으로, 전체적으로 높은 정확성을 유지하고 있음을 보여줍니다. |
| **완성도** | 18.2 | 17 | 20 | 완성도 평가에서는 평균 18.2점, 최저 17점, 최고 20점으로 나타났습니다. 이는 결과물이 충분히 완성도 있게 제공되고 있음을 시사합니다. |
| **관련성** | 19.4 | 19 | 20 | 관련성 항목은 평균 19.4점으로, 최저 19점, 최고 20점의 우수한 평가를 받았습니다. 이는 제공된 정보가 매우 높은 관련성을 가지고 있음을 보여줍니다. |

# **7\. 종합 결론**

총 건수 75, PASS 69 (92.0%), FAIL 0 (0.0%), REJECTED 0 (0.0%), ERROR 6\. (출처: 2026-02-12\_qa\_batch\_analysis.md)

### **핵심 결과:**

| 항목 | 값 |
| :---: | ----- |
| **ERROR 건수** | 6 |
| **ERROR 상세** | V-029; V-038; V-046; V-053; V-071; V-072 ‘MainRouter’ object has no attribute ‘rag\_chain’ |
| **FAIL 건수** | 0 |
| **PASS 비율** | 69/69 \= 100% |
| **평균 점수** | 91.1 / 100 |
| **만점 건수** | V-020 |
| **복합 도메인 처리 성공** | 56 |
| **비용** | $0.1498 |
| **출처** | 2026-02-12\_qa\_batch\_analysis.md |

 