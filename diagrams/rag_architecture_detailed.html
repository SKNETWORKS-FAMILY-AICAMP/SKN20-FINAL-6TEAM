<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RAG Pipeline Architecture - Detailed</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body class="bg-slate-50 min-h-screen p-8">
    <div class="max-w-6xl mx-auto">
        <!-- Title -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-slate-800 mb-2">RAG Pipeline Architecture</h1>
            <p class="text-lg text-slate-500">LangGraph-based Multi-Agent Retrieval System</p>
        </div>

        <!-- Main Flow -->
        <div class="flex flex-col items-center gap-4">

            <!-- Stage 1: User Query -->
            <div class="bg-white border-2 border-slate-300 rounded-xl px-8 py-4 shadow-sm">
                <div class="text-center">
                    <span class="text-2xl mr-2">üë§</span>
                    <span class="font-semibold text-slate-700 text-lg">User Query</span>
                </div>
                <p class="text-slate-500 text-sm mt-1 italic text-center">"Ï†ïÏ±ÖÏûêÍ∏à Ïã†Ï≤≠ ÏûêÍ≤© ÏöîÍ±¥Ïù¥ Ïñ¥ÎñªÍ≤å ÎêòÎÇòÏöî?"</p>
            </div>

            <!-- Arrow -->
            <div class="w-0.5 h-6 bg-cyan-600"></div>
            <div class="w-0 h-0 border-l-8 border-r-8 border-t-8 border-l-transparent border-r-transparent border-t-cyan-600"></div>

            <!-- Stage 2: Domain Classification -->
            <div class="bg-teal-600 rounded-2xl px-8 py-5 shadow-lg w-full max-w-2xl">
                <div class="flex items-center justify-center gap-3 mb-3">
                    <span class="bg-white/20 text-white text-sm font-bold px-3 py-1 rounded-full">STAGE 1</span>
                    <span class="text-white font-bold text-lg">Domain Classification</span>
                </div>
                <div class="flex justify-center gap-4">
                    <div class="bg-white/20 rounded-lg px-4 py-2">
                        <span class="text-white text-sm font-medium">üî§ Keyword Matching</span>
                    </div>
                    <div class="bg-white/20 rounded-lg px-4 py-2">
                        <span class="text-white text-sm font-medium">ü§ñ LLM Classification</span>
                    </div>
                </div>
            </div>

            <!-- Arrow -->
            <div class="w-0.5 h-6 bg-cyan-600"></div>
            <div class="w-0 h-0 border-l-8 border-r-8 border-t-8 border-l-transparent border-r-transparent border-t-cyan-600"></div>

            <!-- Stage 3: Agent Router -->
            <div class="bg-emerald-500 rounded-2xl px-8 py-5 shadow-lg w-full max-w-2xl">
                <div class="flex items-center justify-center gap-3 mb-2">
                    <span class="bg-white/20 text-white text-sm font-bold px-3 py-1 rounded-full">STAGE 2</span>
                    <span class="text-white font-bold text-lg">Agent Router</span>
                </div>
                <p class="text-white/80 text-sm text-center">LangGraph StateGraph - Domain-based Routing</p>
                <div class="flex justify-center mt-2">
                    <code class="bg-white/20 text-white text-xs px-3 py-1 rounded font-mono">route_query()</code>
                </div>
            </div>

            <!-- Branching Arrows -->
            <div class="relative w-full max-w-4xl h-16">
                <svg class="w-full h-full" viewBox="0 0 800 60">
                    <!-- Left branch -->
                    <path d="M400,0 L400,20 L133,20 L133,60" stroke="#64748b" stroke-width="2" fill="none"/>
                    <polygon points="133,60 128,50 138,50" fill="#64748b"/>
                    <!-- Center branch -->
                    <path d="M400,0 L400,60" stroke="#64748b" stroke-width="2" fill="none"/>
                    <polygon points="400,60 395,50 405,50" fill="#64748b"/>
                    <!-- Right branch -->
                    <path d="M400,0 L400,20 L667,20 L667,60" stroke="#64748b" stroke-width="2" fill="none"/>
                    <polygon points="667,60 662,50 672,50" fill="#64748b"/>
                </svg>
            </div>

            <!-- Specialist Agents -->
            <div class="grid grid-cols-3 gap-6 w-full max-w-4xl">
                <!-- StartupFunding Agent -->
                <div class="bg-teal-600 rounded-xl p-4 shadow-lg">
                    <div class="text-center">
                        <span class="text-white font-bold">StartupFunding</span>
                        <span class="text-white font-bold block">Agent</span>
                        <span class="text-white/70 text-sm block mt-1">Ï∞ΩÏóÖ / ÏßÄÏõêÏÇ¨ÏóÖ</span>
                    </div>
                </div>
                <!-- FinanceTax Agent -->
                <div class="bg-blue-500 rounded-xl p-4 shadow-lg">
                    <div class="text-center">
                        <span class="text-white font-bold">FinanceTax</span>
                        <span class="text-white font-bold block">Agent</span>
                        <span class="text-white/70 text-sm block mt-1">Ïû¨Î¨¥ / ÏÑ∏Î¨¥</span>
                    </div>
                </div>
                <!-- HRLabor Agent -->
                <div class="bg-amber-500 rounded-xl p-4 shadow-lg">
                    <div class="text-center">
                        <span class="text-white font-bold">HRLabor</span>
                        <span class="text-white font-bold block">Agent</span>
                        <span class="text-white/70 text-sm block mt-1">Ïù∏ÏÇ¨ / ÎÖ∏Î¨¥</span>
                    </div>
                </div>
            </div>

            <!-- ChromaDB Label -->
            <div class="bg-green-500 rounded-full px-6 py-2 shadow-md mt-4">
                <span class="text-white font-semibold">üíæ ChromaDB (BGE-M3 Embeddings)</span>
            </div>

            <!-- VectorDB Collections - ÏàòÏ†ïÎêú Íµ¨Ï°∞ -->
            <div class="w-full max-w-5xl mt-2">
                <!-- ÏÉÅÎã®: ÏóêÏù¥Ï†ÑÌä∏Î≥Ñ Ï†ÑÏö© Ïª¨Î†âÏÖò -->
                <div class="grid grid-cols-3 gap-6 mb-4">
                    <!-- StartupFunding Ï†ÑÏö© -->
                    <div class="border-2 border-teal-500 bg-teal-50 rounded-lg p-4">
                        <div class="font-semibold text-slate-700">startup_funding_db</div>
                        <div class="text-slate-500 text-sm">5,200 documents</div>
                        <div class="text-slate-400 text-xs mt-1">Ï∞ΩÏóÖÍ∞ÄÏù¥Îìú, Ï†ïÏ±ÖÏûêÍ∏à</div>
                    </div>
                    <!-- FinanceTax Ï†ÑÏö© -->
                    <div class="border-2 border-blue-500 bg-blue-50 rounded-lg p-4">
                        <div class="font-semibold text-slate-700">finance_tax_db</div>
                        <div class="text-slate-500 text-sm">2,800 documents</div>
                        <div class="text-slate-400 text-xs mt-1">Ïû¨Î¨¥, ÏÑ∏Î¨¥ Î≤ïÎ†π</div>
                    </div>
                    <!-- HRLabor Ï†ÑÏö© -->
                    <div class="border-2 border-amber-500 bg-amber-50 rounded-lg p-4">
                        <div class="font-semibold text-slate-700">hr_labor_db</div>
                        <div class="text-slate-500 text-sm">2,200 documents</div>
                        <div class="text-slate-400 text-xs mt-1">Ïù∏ÏÇ¨, ÎÖ∏Î¨¥ Î≤ïÎ†π</div>
                    </div>
                </div>

                <!-- ÌïòÎã®: Í≥µÌÜµ Ïª¨Î†âÏÖò (Î™®Îì† ÏóêÏù¥Ï†ÑÌä∏Í∞Ä Ï†ëÍ∑º) -->
                <div class="relative">
                    <!-- Ïó∞Í≤∞ÏÑ† SVG -->
                    <svg class="absolute -top-4 left-0 w-full h-8" viewBox="0 0 800 30">
                        <!-- ÏôºÏ™Ω ÏóêÏù¥Ï†ÑÌä∏ÏóêÏÑú Í≥µÌÜµDBÎ°ú -->
                        <path d="M133,0 L133,15 L400,15 L400,30" stroke="#8b5cf6" stroke-width="2" fill="none" stroke-dasharray="4"/>
                        <!-- Ï§ëÏïô ÏóêÏù¥Ï†ÑÌä∏ÏóêÏÑú Í≥µÌÜµDBÎ°ú -->
                        <path d="M400,0 L400,30" stroke="#8b5cf6" stroke-width="2" fill="none" stroke-dasharray="4"/>
                        <!-- Ïò§Î•∏Ï™Ω ÏóêÏù¥Ï†ÑÌä∏ÏóêÏÑú Í≥µÌÜµDBÎ°ú -->
                        <path d="M667,0 L667,15 L400,15 L400,30" stroke="#8b5cf6" stroke-width="2" fill="none" stroke-dasharray="4"/>
                    </svg>

                    <div class="border-3 border-violet-500 bg-violet-50 rounded-xl p-5 mt-4 border-2">
                        <div class="flex items-center justify-between">
                            <div>
                                <div class="flex items-center gap-2">
                                    <span class="bg-violet-500 text-white text-xs font-bold px-2 py-1 rounded">Í≥µÌÜµ</span>
                                    <span class="font-bold text-slate-700 text-lg">law_common_db</span>
                                </div>
                                <div class="text-slate-500 text-sm mt-1">8,400 documents</div>
                            </div>
                            <div class="text-right">
                                <div class="text-slate-600 text-sm">Î™®Îì† ÏóêÏù¥Ï†ÑÌä∏Í∞Ä Í≥µÌÜµÏúºÎ°ú Ï†ëÍ∑º</div>
                                <div class="flex gap-2 mt-2 justify-end">
                                    <span class="bg-slate-200 text-slate-600 text-xs px-2 py-1 rounded">Î≤ïÎ†π</span>
                                    <span class="bg-slate-200 text-slate-600 text-xs px-2 py-1 rounded">Î≤ïÎ†πÌï¥ÏÑùÎ°Ä</span>
                                    <span class="bg-slate-200 text-slate-600 text-xs px-2 py-1 rounded">ÌåêÎ°Ä</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Arrow -->
            <div class="w-0.5 h-6 bg-cyan-600 mt-4"></div>
            <div class="w-0 h-0 border-l-8 border-r-8 border-t-8 border-l-transparent border-r-transparent border-t-cyan-600"></div>

            <!-- Stage 4: Hybrid Search -->
            <div class="bg-amber-500 rounded-2xl px-8 py-5 shadow-lg w-full max-w-4xl">
                <div class="flex items-center justify-center gap-3 mb-2">
                    <span class="bg-white/20 text-white text-sm font-bold px-3 py-1 rounded-full">STAGE 3</span>
                    <span class="text-white font-bold text-lg">Hybrid Search</span>
                </div>
                <p class="text-white/80 text-xs text-center mb-4">‚ö° Í∞Å Í≤ÄÏÉâ Î∞©Î≤ïÏùÄ ON/OFF ÌÜ†Í∏Ä Í∞ÄÎä•</p>
                <div class="grid grid-cols-4 gap-3">
                    <div class="bg-white/20 rounded-lg p-3 text-center">
                        <div class="text-white font-semibold text-sm">Vector Search</div>
                        <div class="text-white/70 text-xs mt-1">MMR (Semantic)</div>
                        <div class="mt-2">
                            <span class="bg-green-400 text-white text-xs px-2 py-0.5 rounded-full">Always ON</span>
                        </div>
                    </div>
                    <div class="bg-white/20 rounded-lg p-3 text-center border-2 border-white/40">
                        <div class="text-white font-semibold text-sm">BM25 Search</div>
                        <div class="text-white/70 text-xs mt-1">Keyword Matching</div>
                        <div class="mt-2">
                            <span class="bg-blue-400 text-white text-xs px-2 py-0.5 rounded-full">ON/OFF</span>
                        </div>
                    </div>
                    <div class="bg-white/20 rounded-lg p-3 text-center border-2 border-white/40">
                        <div class="text-white font-semibold text-sm">RRF Fusion</div>
                        <div class="text-white/70 text-xs mt-1">k=60 Integration</div>
                        <div class="mt-2">
                            <span class="bg-blue-400 text-white text-xs px-2 py-0.5 rounded-full">ON/OFF</span>
                        </div>
                    </div>
                    <div class="bg-white/20 rounded-lg p-3 text-center border-2 border-white/40">
                        <div class="text-white font-semibold text-sm">LLM Reranking</div>
                        <div class="text-white/70 text-xs mt-1">Relevance Reorder</div>
                        <div class="mt-2">
                            <span class="bg-blue-400 text-white text-xs px-2 py-0.5 rounded-full">ON/OFF</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Arrow -->
            <div class="w-0.5 h-6 bg-cyan-600"></div>
            <div class="w-0 h-0 border-l-8 border-r-8 border-t-8 border-l-transparent border-r-transparent border-t-cyan-600"></div>

            <!-- Stage 5: Evaluation -->
            <div class="bg-violet-500 rounded-2xl px-8 py-5 shadow-lg w-full max-w-3xl">
                <div class="flex items-center justify-center gap-3 mb-3">
                    <span class="bg-white/20 text-white text-sm font-bold px-3 py-1 rounded-full">STAGE 4</span>
                    <span class="text-white font-bold text-lg">Relevance Evaluation</span>
                </div>
                <div class="flex justify-center gap-6">
                    <div class="text-center">
                        <div class="text-white font-semibold">Relevance Score</div>
                        <div class="text-white/70 text-sm">Î¨∏ÏÑú Í¥ÄÎ†®ÏÑ± ÌèâÍ∞Ä</div>
                    </div>
                    <div class="text-center border-l border-white/30 pl-6">
                        <div class="text-white font-semibold">Threshold: 70pts</div>
                        <div class="text-white/70 text-sm">ÌíàÏßà Í∏∞Ï§ÄÏ†ê</div>
                    </div>
                    <div class="text-center border-l border-white/30 pl-6">
                        <div class="text-white font-semibold">Top-K Selection</div>
                        <div class="text-white/70 text-sm">ÏÉÅÏúÑ Î¨∏ÏÑú ÏÑ†ÌÉù</div>
                    </div>
                </div>
            </div>

            <!-- Arrow -->
            <div class="w-0.5 h-6 bg-cyan-600"></div>
            <div class="w-0 h-0 border-l-8 border-r-8 border-t-8 border-l-transparent border-r-transparent border-t-cyan-600"></div>

            <!-- Stage 6: Generation -->
            <div class="bg-green-500 rounded-2xl px-8 py-5 shadow-lg w-full max-w-3xl">
                <div class="flex items-center justify-center gap-3 mb-2">
                    <span class="bg-white/20 text-white text-sm font-bold px-3 py-1 rounded-full">STAGE 5</span>
                    <span class="text-white font-bold text-lg">Response Generation</span>
                </div>
                <div class="flex justify-center gap-4 mt-3">
                    <div class="bg-white/20 rounded-lg px-4 py-2">
                        <span class="text-white text-sm font-medium">üß† GPT-4o-mini</span>
                    </div>
                    <div class="bg-white/20 rounded-lg px-4 py-2">
                        <span class="text-white text-sm font-medium">üìé Source Citation</span>
                    </div>
                    <div class="bg-white/20 rounded-lg px-4 py-2">
                        <span class="text-white text-sm font-medium">‚ú® Context Integration</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Side Panels -->
        <div class="grid grid-cols-2 gap-8 mt-12 max-w-4xl mx-auto">
            <!-- Chunking Strategy -->
            <div class="bg-white rounded-xl p-6 shadow-md border border-slate-200">
                <h3 class="font-bold text-slate-700 text-lg mb-2 flex items-center gap-2">
                    <span class="text-xl">‚öôÔ∏è</span> Chunking Strategy
                </h3>
                <p class="text-slate-500 text-xs mb-4">Îç∞Ïù¥ÌÑ∞ Ïú†ÌòïÎ≥Ñ ÏµúÏ†ÅÌôîÎêú Ï≤≠ÌÇπ Ï†ÑÎûµ Ï†ÅÏö©</p>
                <div class="space-y-2">
                    <div class="p-2 bg-teal-50 rounded-lg border-l-4 border-teal-500">
                        <div class="font-semibold text-slate-700 text-sm">Î≤ïÎ†π</div>
                        <div class="text-slate-500 text-xs">800Ïûê / 100Ïûê overlap</div>
                    </div>
                    <div class="p-2 bg-emerald-50 rounded-lg border-l-4 border-emerald-500">
                        <div class="font-semibold text-slate-700 text-sm">Î≤ïÎ†πÌï¥ÏÑùÎ°Ä (PDF)</div>
                        <div class="text-slate-500 text-xs">1000Ïûê / 150Ïûê overlap</div>
                    </div>
                    <div class="p-2 bg-amber-50 rounded-lg border-l-4 border-amber-500">
                        <div class="font-semibold text-slate-700 text-sm">ÌåêÎ°Ä</div>
                        <div class="text-slate-500 text-xs">1200Ïûê / 200Ïûê overlap</div>
                    </div>
                    <div class="p-2 bg-violet-50 rounded-lg border-l-4 border-violet-500">
                        <div class="font-semibold text-slate-700 text-sm">Ï∞ΩÏóÖÍ∞ÄÏù¥Îìú</div>
                        <div class="text-slate-500 text-xs">600Ïûê / 100Ïûê overlap</div>
                    </div>
                </div>
                <div class="mt-4 pt-3 border-t border-slate-200">
                    <div class="flex justify-between items-center text-sm">
                        <span class="text-slate-600">Embedding</span>
                        <span class="font-semibold text-slate-800">BGE-M3 (1024d)</span>
                    </div>
                    <div class="flex justify-between items-center text-sm mt-1">
                        <span class="text-slate-600">HR@5</span>
                        <span class="font-semibold text-green-600">42% (+26%)</span>
                    </div>
                </div>
            </div>

            <!-- Data Sources -->
            <div class="bg-white rounded-xl p-6 shadow-md border border-slate-200">
                <h3 class="font-bold text-slate-700 text-lg mb-2 flex items-center gap-2">
                    <span class="text-xl">üìä</span> Data Sources
                </h3>
                <p class="text-slate-500 text-sm mb-4">Total: 18,600 Documents</p>
                <div class="space-y-3">
                    <div class="flex justify-between items-center p-2 bg-teal-50 rounded-lg border-l-4 border-teal-500">
                        <span class="text-slate-700">Î≤ïÎ†π (Laws)</span>
                        <span class="font-semibold text-teal-600">4,200</span>
                    </div>
                    <div class="flex justify-between items-center p-2 bg-emerald-50 rounded-lg border-l-4 border-emerald-500">
                        <span class="text-slate-700">Î≤ïÎ†πÌï¥ÏÑùÎ°Ä (Interpretations)</span>
                        <span class="font-semibold text-emerald-600">3,800</span>
                    </div>
                    <div class="flex justify-between items-center p-2 bg-amber-50 rounded-lg border-l-4 border-amber-500">
                        <span class="text-slate-700">ÌåêÎ°Ä (Precedents)</span>
                        <span class="font-semibold text-amber-600">5,400</span>
                    </div>
                    <div class="flex justify-between items-center p-2 bg-violet-50 rounded-lg border-l-4 border-violet-500">
                        <span class="text-slate-700">Ï∞ΩÏóÖÍ∞ÄÏù¥Îìú (Startup Guide)</span>
                        <span class="font-semibold text-violet-600">5,200</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Collection Summary -->
        <div class="mt-8 max-w-4xl mx-auto">
            <div class="bg-white rounded-xl p-6 shadow-md border border-slate-200">
                <h3 class="font-bold text-slate-700 text-lg mb-4 flex items-center gap-2">
                    <span class="text-xl">üóÑÔ∏è</span> VectorDB Collections Summary
                </h3>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm">
                        <thead>
                            <tr class="border-b-2 border-slate-200">
                                <th class="text-left py-2 px-3 text-slate-600">Collection</th>
                                <th class="text-left py-2 px-3 text-slate-600">Documents</th>
                                <th class="text-left py-2 px-3 text-slate-600">Sources</th>
                                <th class="text-left py-2 px-3 text-slate-600">Used By</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="border-b border-slate-100">
                                <td class="py-3 px-3 font-medium text-teal-600">startup_funding_db</td>
                                <td class="py-3 px-3">5,200</td>
                                <td class="py-3 px-3 text-slate-500">Ï∞ΩÏóÖÍ∞ÄÏù¥Îìú, Ï†ïÏ±ÖÏûêÍ∏à</td>
                                <td class="py-3 px-3"><span class="bg-teal-100 text-teal-700 px-2 py-1 rounded text-xs">StartupFunding</span></td>
                            </tr>
                            <tr class="border-b border-slate-100">
                                <td class="py-3 px-3 font-medium text-blue-600">finance_tax_db</td>
                                <td class="py-3 px-3">2,800</td>
                                <td class="py-3 px-3 text-slate-500">Ïû¨Î¨¥, ÏÑ∏Î¨¥ Î≤ïÎ†π</td>
                                <td class="py-3 px-3"><span class="bg-blue-100 text-blue-700 px-2 py-1 rounded text-xs">FinanceTax</span></td>
                            </tr>
                            <tr class="border-b border-slate-100">
                                <td class="py-3 px-3 font-medium text-amber-600">hr_labor_db</td>
                                <td class="py-3 px-3">2,200</td>
                                <td class="py-3 px-3 text-slate-500">Ïù∏ÏÇ¨, ÎÖ∏Î¨¥ Î≤ïÎ†π</td>
                                <td class="py-3 px-3"><span class="bg-amber-100 text-amber-700 px-2 py-1 rounded text-xs">HRLabor</span></td>
                            </tr>
                            <tr>
                                <td class="py-3 px-3 font-medium text-violet-600">law_common_db</td>
                                <td class="py-3 px-3">8,400</td>
                                <td class="py-3 px-3 text-slate-500">Î≤ïÎ†π, Î≤ïÎ†πÌï¥ÏÑùÎ°Ä, ÌåêÎ°Ä</td>
                                <td class="py-3 px-3">
                                    <span class="bg-teal-100 text-teal-700 px-2 py-1 rounded text-xs mr-1">StartupFunding</span>
                                    <span class="bg-blue-100 text-blue-700 px-2 py-1 rounded text-xs mr-1">FinanceTax</span>
                                    <span class="bg-amber-100 text-amber-700 px-2 py-1 rounded text-xs">HRLabor</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Tech Stack -->
        <div class="flex justify-center gap-6 mt-10">
            <div class="flex items-center gap-2">
                <div class="w-3 h-3 rounded-full bg-teal-500"></div>
                <span class="text-slate-600 text-sm">LangGraph</span>
            </div>
            <div class="flex items-center gap-2">
                <div class="w-3 h-3 rounded-full bg-emerald-500"></div>
                <span class="text-slate-600 text-sm">LangChain</span>
            </div>
            <div class="flex items-center gap-2">
                <div class="w-3 h-3 rounded-full bg-amber-500"></div>
                <span class="text-slate-600 text-sm">BGE-M3</span>
            </div>
            <div class="flex items-center gap-2">
                <div class="w-3 h-3 rounded-full bg-green-500"></div>
                <span class="text-slate-600 text-sm">ChromaDB</span>
            </div>
            <div class="flex items-center gap-2">
                <div class="w-3 h-3 rounded-full bg-violet-500"></div>
                <span class="text-slate-600 text-sm">OpenAI</span>
            </div>
        </div>

        <!-- Footer -->
        <div class="text-center mt-8 text-slate-400 text-sm">
            Bizi - ÌÜµÌï© Ï∞ΩÏóÖ/Í≤ΩÏòÅ ÏÉÅÎã¥ Ï±óÎ¥á | Team EasyBizi
        </div>
    </div>
</body>
</html>
